<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SE205 - Unit 4: Message Authentication and Hash Functions</title>
     <style>
        /* Paste the CSS from the SE205 unit1/2/3.html example here */
         body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 30px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        h1, h2, h3, h4 { /* Added h4 */
            color: #0056b3; /* Cairo University Blue */
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #dee2e6;
            padding-bottom: 15px;
        }

        h2 {
            margin-top: 20px;
            margin-bottom: 20px;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 10px;
        }

        h3 {
            margin-top: 25px;
            margin-bottom: 15px;
            color: #007bff; /* Lighter Blue */
        }
        h4 { /* Style for sub-sections within concepts */
             margin-top: 20px;
             margin-bottom: 10px;
             color: #17a2b8; /* Info Blue */
        }

         ul {
            list-style-type: disc;
            padding-left: 20px;
            margin-top: 10px;
        }
         li {
             margin-bottom: 8px;
         }
         ol { /* Style ordered lists too */
             padding-left: 25px;
             margin-top: 10px;
         }
        code, pre { /* Apply styling to pre for code blocks */
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            background-color: #e9ecef;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.95em;
            display: block; /* Make pre block-level */
            overflow-x: auto; /* Add scroll for long code lines */
            padding: 10px; /* More padding for pre */
            margin-top: 10px;
            margin-bottom: 10px;
            border: 1px solid #dee2e6;
        }
        strong { /* Use default strong for emphasis, specific class for keywords */
             /*color: #dc3545; */ /* Red emphasis */
        }
        .keyword { /* Class for highlighting keywords */
            font-weight: bold;
            color: #dc3545; /* Red */
        }
         .formula { /* Specific style for formula display */
            font-weight: bold;
            color: #28a745; /* Green */
            margin: 10px 0;
            padding: 5px;
            background-color: #f0fff0;
            border-left: 3px solid #28a745;
         }
         .example {
             margin-top: 15px;
             padding-left: 15px;
             border-left: 3px solid #17a2b8; /* Info Blue */
             background-color: #f8f9fa;
             padding: 15px;
             border-radius: 4px;
         }
          .solution {
             margin-top: 10px;
             padding-left: 15px;
             font-style: italic;
             color: #555;
         }
         .solution code, .solution pre {
            font-style: normal; /* Keep code normal style */
            background-color: #e0e0e0; /* Slightly darker bg for solution code */
         }
        .diagram img { /* Style for embedded images */
            max-width: 100%;
            height: auto;
            border: 1px solid #ccc;
            margin-top: 10px;
            margin-bottom: 10px;
            display: block;
            margin-left: auto;
            margin-right: auto;
         }
         figcaption {
             text-align: center;
             font-style: italic;
             color: #666;
             font-size: 0.9em;
             margin-bottom: 15px;
         }

        /* Main Tabs Styles */
        .main-tabs {
            display: flex;
            justify-content: space-around; /* Or flex-start, center */
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
            margin-bottom: 25px;
            border-bottom: 2px solid #0056b3;
        }

        .main-tabs .tab-button {
            padding: 12px 20px; /* Adjusted padding slightly */
            border: none;
            background: none;
            color: #0056b3;
            font-size: 0.95em; /* Slightly smaller font */
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
            transition: background-color 0.3s ease, color 0.3s ease;
            margin-bottom: -2px; /* Overlap border */
            border-bottom: 2px solid transparent;
            text-align: center;
        }

        .main-tabs .tab-button.active {
            background: #0056b3;
            color: white;
            border-bottom: 2px solid #0056b3;
        }
        .main-tabs .tab-button:hover:not(.active) {
            background-color: #e9ecef;
            border-bottom: 2px solid #adb5bd;
        }

        /* Content Sections */
        .main-content {
            display: none; /* Hide all main content sections by default */
            animation: fadeIn 0.5s;
        }

        .main-content.active {
            display: block; /* Show only the active one */
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }


        /* --- Accordion Styles (for Glossary) --- */
        .glossary-accordion {
            border: 1px solid #dee2e6;
            border-radius: 5px;
            overflow: hidden; /* Contain borders */
        }

        .accordion-item {
            border-bottom: 1px solid #dee2e6; /* Separator */
        }
        .accordion-item:last-child {
            border-bottom: none;
        }

        .accordion-header {
            background-color: #f8f9fa;
            color: #dc3545; /* Highlight Red for terms */
            cursor: pointer;
            padding: 15px 20px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s ease;
            position: relative; /* For the indicator */
        }

        .accordion-header:hover {
            background-color: #e9ecef;
        }

        /* Indicator (+/-) */
        .accordion-header::after {
            content: '\002B'; /* + sign */
            color: #0056b3;
            font-weight: bold;
            float: right;
            margin-left: 5px;
            transition: transform 0.2s ease-in-out;
        }

        .accordion-header.active::after {
            content: "\2212"; /* - sign */
            transform: rotate(180deg); /* Optional: animate the sign itself */
        }
        /* Optional: Slightly different style for active header */
        .accordion-header.active {
             background-color: #e7f1ff;
        }


        .accordion-panel {
            padding: 0 20px; /* Start with 0 padding top/bottom */
            background-color: white;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out; /* Smooth transition */
        }
        .accordion-panel p, .accordion-panel ul { /* Apply margin to lists too */
            margin: 15px 0; /* Add margin back when panel is open */
            color: #333; /* Reset color for definition */
        }
        .accordion-panel pre { /* Style code blocks inside accordion */
             margin: 15px 0;
             background-color: #f1f1f1;
        }

        /* --- End Accordion Styles --- */

        /* Concepts Section Styles */
        #concepts .concept-block {
            background-color: #ffffff; /* White background for concept blocks */
            border: 1px solid #e9ecef;
            padding: 0; /* Remove padding here, apply to header/content */
            border-radius: 5px;
            margin-bottom: 25px;
             box-shadow: 0 2px 4px rgba(0,0,0,0.05);
             overflow: hidden; /* Contain borders */
        }
         /* Style for the clickable concept header (h3) */
         #concepts .concept-header {
            margin: 0; /* Remove default h3 margin */
            padding: 15px 20px;
            cursor: pointer;
            background-color: #f8f9fa;
            color: #007bff;
            border-bottom: 1px solid #e9ecef; /* Separator */
            transition: background-color 0.3s ease;
            position: relative; /* For indicator */
            font-size: 1.2em; /* Adjust size if needed */
        }
        #concepts .concept-header:hover {
            background-color: #e9ecef;
        }
        /* Indicator (+/-) for concept headers */
        #concepts .concept-header::after {
            content: '\002B'; /* + sign */
            color: #0056b3;
            font-weight: bold;
            float: right;
            margin-left: 10px;
            transition: transform 0.2s ease-in-out;
        }
        #concepts .concept-header.active::after {
            content: "\2212"; /* - sign */
            /* transform: rotate(180deg); */ /* Optional rotation */
        }
        #concepts .concept-header.active {
             background-color: #e7f1ff; /* Slightly different bg when active */
        }

        /* Style for the collapsible content within concepts */
        #concepts .concept-content {
            padding: 0 20px; /* Start with 0 padding top/bottom */
            background-color: white;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out; /* Smooth transition */
            border-top: none; /* Avoid double border */
        }
        #concepts .concept-content > *:first-child {
            margin-top: 15px; /* Add margin to first element inside */
        }
        #concepts .concept-content > *:last-child {
            margin-bottom: 20px; /* Add margin to last element inside */
        }
        /* Ensure nested elements inside concept-content have appropriate margin */
        #concepts .concept-content p,
        #concepts .concept-content ul,
        #concepts .concept-content ol,
        #concepts .concept-content table,
        #concepts .concept-content .diagram,
        #concepts .concept-content h4 { /* Include h4 */
            margin-top: 15px;
            margin-bottom: 15px;
        }
        #concepts .concept-content h4 {
             color: #17a2b8; /* Keep h4 color */
             border-bottom: 1px dotted #ccc;
             padding-bottom: 5px;
        }

        .requirements-table {
            width: 100%;
            border-collapse: collapse;
            /* margin-top: 15px; */ /* Removed, handled by parent */
        }
         .requirements-table th, .requirements-table td {
             border: 1px solid #ddd;
             padding: 8px 10px;
             text-align: left;
             font-size: 0.9em;
         }
         .requirements-table th {
             background-color: #e9ecef;
             font-weight: bold;
         }


        /* Quiz Styles (apply within #fill, #tf, #mc) */
        .question {
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            background-color: #ffffff; /* White background for questions */
            position: relative; /* For feedback positioning */
        }

        .question p {
            margin: 0 0 15px;
            font-weight: bold;
            font-size: 1.05em;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-button {
            padding: 10px 15px;
            border: 1px solid #ced4da;
            background: #f8f9fa; /* Light background for options */
            color: #495057;
            cursor: pointer;
            border-radius: 5px;
            text-align: left;
            transition: background-color 0.2s ease, border-color 0.2s ease;
            width: 100%;
        }
        .option-button:hover {
             background-color: #e9ecef;
             border-color: #adb5bd;
        }

        .option-button.selected {
            background: #007bff;
            color: white;
            border-color: #0056b3;
        }

        .check-answer {
            margin-top: 15px;
            padding: 10px 20px;
            border: none;
            background: #28a745; /* Success Green */
            color: white;
            cursor: pointer;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.2s ease;
        }
        .check-answer:hover {
             background-color: #218838;
        }

        .feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>SE205 - Unit 4: Message Authentication and Hash Functions</h1>

        <!-- Main Tab Buttons -->
        <div class="main-tabs">
            <button class="tab-button active" data-tab="glossary">Glossary</button>
            <button class="tab-button" data-tab="concepts">Key Concepts & Examples</button>
            <button class="tab-button" data-tab="fill">Fill in the Blank</button>
            <button class="tab-button" data-tab="tf">True/False</button>
            <button class="tab-button" data-tab="mc">Multiple Choice</button>
        </div>

        <!-- Glossary Section (Accordion) -->
        <section id="glossary" class="main-content active">
            <h2>Glossary of Terms</h2>
            <div class="glossary-accordion">
                 <div class="accordion-item">
                    <button class="accordion-header">Authentication</button>
                    <div class="accordion-panel">
                        <p>The process of verifying the identity of a user, process, or device, often as a prerequisite to granting access to resources. Also refers to verifying the source and integrity of data.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Birthday Attack</button>
                    <div class="accordion-panel">
                        <p>A type of cryptanalytic attack based on the mathematics of the birthday problem. It makes finding a collision for a hash function easier than brute-force, requiring roughly 2<sup>n/2</sup> attempts for an n-bit hash.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Block Hash (Blockchain)</button>
                    <div class="accordion-panel">
                        <p>A unique identifier for a block in a blockchain, generated by hashing the block's header content. Acts as a digital fingerprint and links blocks together.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">Blockchain</button>
                    <div class="accordion-panel">
                        <p>A distributed, immutable digital ledger that stores records (transactions) in blocks, chronologically linked using cryptography (hashes).</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">CBC (Cipher Block Chaining)</button>
                    <div class="accordion-panel">
                        <p>A mode of operation for block ciphers where each block of plaintext is XORed with the previous ciphertext block before being encrypted. Can be used as a basis for MAC algorithms (e.g., CMAC).</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">CMAC (Cipher-based MAC)</button>
                    <div class="accordion-panel">
                        <p>A type of Message Authentication Code (MAC) algorithm based on a symmetric block cipher (like AES), rather than a hash function.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Collision (Hash)</button>
                    <div class="accordion-panel">
                        <p>Occurs when two different input messages produce the exact same hash output value. Cryptographic hash functions aim to be collision-resistant.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Collision Resistance</button>
                    <div class="accordion-panel">
                        <p>A property of cryptographic hash functions. Strong collision resistance means it's computationally infeasible to find *any* two different inputs M1, M2 such that H(M1) = H(M2). Weak collision resistance (or second preimage resistance) means given an input M1, it's infeasible to find a different M2 such that H(M1) = H(M2).</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Data Integrity</button>
                    <div class="accordion-panel">
                        <p>The assurance that digital information has not been altered in an unauthorized way since it was created, transmitted, or stored. Hash functions and MACs are primary tools for ensuring this.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Digital Signature</button>
                    <div class="accordion-panel">
                        <p>A cryptographic mechanism used to verify the authenticity (origin), integrity (unaltered content), and non-repudiation (sender cannot deny sending) of digital data. Typically created by hashing the data and encrypting the hash with the sender's private key.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Hash Function</button>
                    <div class="accordion-panel">
                        <p>A mathematical algorithm that takes an arbitrary block of data (input message) and returns a fixed-size bit string (the hash value or message digest), such that any change to the data will (with high probability) change the hash value. Key properties include being one-way and collision-resistant.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">HMAC (Hash-based MAC)</button>
                    <div class="accordion-panel">
                        <p>A specific type of Message Authentication Code (MAC) involving a cryptographic hash function (like SHA-256) in combination with a secret cryptographic key.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">Keccak</button>
                    <div class="accordion-panel">
                        <p>The cryptographic algorithm based on the sponge construction that was selected as the winner of the NIST hash function competition and became the SHA-3 standard.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">Keyed Hash Function</button>
                    <div class="accordion-panel">
                        <p>Another term for a Message Authentication Code (MAC), emphasizing that the hash calculation incorporates a secret key shared between the parties.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">MAC (Message Authentication Code)</button>
                    <div class="accordion-panel">
                        <p>A short piece of information generated using a secret key and a cryptographic algorithm (either hash-based like HMAC or cipher-based like CMAC) applied to a message. It verifies both the data integrity and authenticity of the message.</p>
                         <p><code>MAC = f(Key, Message)</code></p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Merkle Root (Blockchain)</button>
                    <div class="accordion-panel">
                        <p>A hash contained in a block header representing the hash of all transactions within that block, constructed using a Merkle Tree. Allows for efficient verification of transaction inclusion.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Merkle–Damgård Construction</button>
                    <div class="accordion-panel">
                        <p>A common structure for building cryptographic hash functions (like MD5, SHA-1, SHA-2). It processes the input message in fixed-size blocks iteratively using a compression function.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">Message Authentication</button>
                    <div class="accordion-panel">
                        <p>A service used to verify the integrity of a message and, often, its origin. Ensures the message received is exactly as sent and came from the purported source.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Message Digest</button>
                    <div class="accordion-panel">
                        <p>The fixed-size output value of a hash function. Also called a hash value.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">Nonce (Blockchain)</button>
                    <div class="accordion-panel">
                        <p>"Number used once." In Proof-of-Work blockchains (like Bitcoin), it's a value in the block header that miners repeatedly change and re-hash until they find a hash value meeting the network's difficulty target.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">One-Way Property (Preimage Resistance)</button>
                    <div class="accordion-panel">
                        <p>A property of cryptographic hash functions: given a hash output h, it is computationally infeasible to find any input x such that H(x) = h.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">Preimage</button>
                    <div class="accordion-panel">
                        <p>For a hash function H and an output h, an input x such that H(x) = h is called a preimage of h.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Proof-of-Stake (PoS)</button>
                    <div class="accordion-panel">
                        <p>A blockchain consensus mechanism where block creators (validators) are chosen based on the number of coins they hold/stake. An alternative to Proof-of-Work.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Proof-of-Work (PoW)</button>
                    <div class="accordion-panel">
                        <p>A blockchain consensus mechanism requiring participants (miners) to solve a computationally intensive puzzle (finding a valid nonce) to validate transactions and create new blocks. Used by Bitcoin.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">SHA (Secure Hash Algorithm)</button>
                    <div class="accordion-panel">
                        <p>A family of cryptographic hash functions published by NIST. Includes SHA-1, SHA-2 (SHA-224, SHA-256, SHA-384, SHA-512), and SHA-3.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">SHA-1</button>
                    <div class="accordion-panel">
                        <p>Produces a 160-bit hash value. Widely used previously but now considered insecure due to practical collision attacks ("broken" in 2017).</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">SHA-2</button>
                    <div class="accordion-panel">
                        <p>A family of hash functions including SHA-256 (256-bit hash) and SHA-512 (512-bit hash). Based on Merkle–Damgård construction. Still considered secure.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">SHA-3</button>
                    <div class="accordion-panel">
                        <p>The latest SHA standard, based on the Keccak algorithm and the sponge construction. Designed as an alternative to SHA-2, with a different internal structure.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">Sponge Construction</button>
                    <div class="accordion-panel">
                        <p>A mode of operation for cryptographic functions, used in Keccak (SHA-3). It takes an input ("absorbing" phase) and produces an output ("squeezing" phase) of variable lengths, acting like a sponge.</p>
                    </div>
                </div>
            </div> <!-- End glossary-accordion -->
        </section>

        <!-- Key Concepts & Examples Section -->
        <section id="concepts" class="main-content">
            <h2>Key Concepts & Examples from Unit 4</h2>

             <div class="concept-block">
                <h3 class="concept-header">Authentication Overview</h3>
                <div class="concept-content">
                    <p>Why Authenticate?</p>
                    <ul>
                        <li>Ensures <span class="keyword">message integrity</span> (data hasn't been altered).</li>
                        <li>Verifies <span class="keyword">sender identity</span> (data is from the claimed source).</li>
                        <li>Prevents <span class="keyword">replay attacks</span> (prevents capturing and resending old messages).</li>
                    </ul>
                    <p>Threats Countered: Disclosure, Masquerade, Content Modification, Sequence Modification.</p>
                    <p>Types of Authentication Functions:</p>
                    <ol>
                        <li>Message Encryption (Symmetric/Asymmetric - provides some auth but primarily confidentiality).</li>
                        <li>Message Authentication Code (MAC).</li>
                        <li>Hash Functions.</li>
                    </ol>
                </div>
             </div>

             <div class="concept-block">
                <h3 class="concept-header">Hash Functions</h3>
                <div class="concept-content">
                    <p>A core tool for ensuring data integrity and enabling authentication mechanisms.</p>
                    <ul>
                        <li>Takes an arbitrary-length input M.</li>
                        <li>Produces a fixed-length output <span class="keyword">h = H(M)</span> (hash value or message digest).</li>
                        <li>Purpose: <span class="keyword">Data Integrity</span>. Also used for password storage, secure authentication, file organization.</li>
                        <li>Based on computationally infeasible properties:
                            <ul>
                                <li><span class="keyword">One-Way Property (Preimage Resistance):</span> Given h, hard to find M such that H(M)=h.</li>
                                <li><span class="keyword">Second Preimage Resistance (Weak Collision Resistance):</span> Given M1, hard to find M2 ≠ M1 such that H(M1)=H(M2).</li>
                                <li><span class="keyword">Collision Resistance (Strong Collision Resistance):</span> Hard to find *any* pair M1 ≠ M2 such that H(M1)=H(M2).</li>
                            </ul>
                        </li>
                    </ul>
                    <div class="diagram">
                        <img src="https://via.placeholder.com/600x200.png?text=Hashing+Diagram+(Input+->+Hash+Function+->+Fixed+Output)" alt="Hashing Process Diagram">
                        <figcaption>General Hashing Process</figcaption>
                    </div>
                    <h4>Hash Function Requirements</h4>
                    <table class="requirements-table">
                        <thead><tr><th>Requirement</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td>Variable input size</td><td>Can be applied to data block of any size.</td></tr>
                            <tr><td>Fixed output size</td><td>Produces a fixed-length output (hash).</td></tr>
                            <tr><td>Efficiency</td><td>H(x) is relatively easy/fast to compute.</td></tr>
                            <tr><td>Preimage resistant (one-way)</td><td>Given h, infeasible to find x such that H(x)=h.</td></tr>
                            <tr><td>Second preimage resistant (weak collision)</td><td>Given x, infeasible to find y≠x with H(y)=H(x).</td></tr>
                            <tr><td>Collision resistant (strong collision)</td><td>Infeasible to find any pair (x, y) with x≠y such that H(x)=H(y).</td></tr>
                            <tr><td>Pseudorandomness</td><td>Output meets standard tests for pseudorandomness.</td></tr>
                        </tbody>
                    </table>
                    <h4>Attacks on Hash Functions</h4>
                    <ul>
                        <li><span class="keyword">Brute-Force Attacks:</span> Depend on hash output length (n).
                            <ul>
                                <li>To find a preimage or second preimage: Requires ~2<sup>n</sup> operations.</li>
                                <li>To find a collision (Birthday Attack): Requires only ~2<sup>n/2</sup> operations. This is often the determining factor for security strength.</li>
                            </ul>
                        </li>
                        <li><span class="keyword">Cryptanalysis:</span> Exploits specific weaknesses in the hash algorithm itself (e.g., collisions found in MD5 and SHA-1).</li>
                    </ul>
                    <h4>Basic Hash Structure (Merkle–Damgård)</h4>
                    <p>Iterative process using a compression function 'f':</p>
                    <ol>
                        <li>Append Padding & Length: Message padded to be multiple of block size (b). Length of original message often appended.</li>
                        <li>Initialize: Start with an initial hash value IV (CV<sub>0</sub>).</li>
                        <li>Process Blocks: For each message block Y<sub>i</sub>: CV<sub>i</sub> = f(CV<sub>i-1</sub>, Y<sub>i</sub>). The output of one stage feeds into the next.</li>
                        <li>Final Hash: The last output CV<sub>L</sub> is the hash value H(M).</li>
                    </ol>
                    <div class="diagram">
                        <img src="https://via.placeholder.com/700x300.png?text=Merkle-Damgard+Structure+(IV+->+f(CV0,Y1)+->+...)" alt="Merkle-Damgard Construction Diagram">
                        <figcaption>Merkle–Damgård Structure</figcaption>
                    </div>
                </div>
             </div>

            <div class="concept-block">
                <h3 class="concept-header">Applications of Hash Functions</h3>
                <div class="concept-content">
                    <h4>Message Authentication (using Hash only)</h4>
                    <p>Basic method: Sender computes h=H(M), sends {M, h}. Receiver recomputes H(M') and compares with received h.</p>
                    <p>Vulnerable to Man-in-the-Middle attack if channel isn't secure (Attacker intercepts {M,h}, replaces with {M', h'=H(M')}).</p>
                    <div class="diagram">
                        <img src="https://via.placeholder.com/700x250.png?text=Hash+for+Integrity+Diagram+(Slide+10a)" alt="Hash for Integrity Check">
                        <figcaption>Using Hash Function to Check Data Integrity</figcaption>
                    </div>
                    <p>Improved Methods (Combining with Encryption/Secrets):</p>
                    <ul>
                        <li><strong>Encrypt Message + Hash:</strong> E(K, [M || H(M)]) - Provides confidentiality and integrity. (Slide 12a)</li>
                        <li><strong>Encrypt Hash Only:</strong> M || E(K, H(M)) - Efficient for large messages, provides integrity but not confidentiality. (Slide 12b)</li>
                        <li><strong>Hashed Secret Value (like MAC):</strong> M || H(M || S) - Uses a shared secret S. Provides integrity/authentication, no encryption needed. (Slide 12c)</li>
                        <li><strong>Encrypted Hashed Secret Value:</strong> E(K, [M || H(M || S)]) - Provides confidentiality and integrity/authentication. (Slide 12d)</li>
                    </ul>

                    <h4>Message Authentication Codes (MACs)</h4>
                    <p>A keyed hash function, provides integrity and authenticity.</p>
                    <p class="formula">MAC = C<sub>K</sub>(M) = f(K, M)</p>
                    <p>Requires sender and receiver to share a secret key K.</p>
                    <ul>
                        <li>Sender computes MAC = C<sub>K</sub>(M), sends {M, MAC}.</li>
                        <li>Receiver computes MAC' = C<sub>K</sub>(M'), compares MAC' with received MAC.</li>
                    </ul>
                    <div class="diagram">
                        <img src="https://via.placeholder.com/600x400.png?text=MAC+Process+Diagram+(Slide+16)" alt="MAC Process Diagram">
                        <figcaption>MAC Generation and Verification</figcaption>
                    </div>
                    <p>Types:</p>
                    <ul>
                        <li><span class="keyword">HMAC:</span> Based on a cryptographic hash function (e.g., HMAC-SHA256).</li>
                        <li><span class="keyword">CMAC:</span> Based on a block cipher (e.g., AES-CMAC).</li>
                    </ul>
                    <p>Must also protect against replay attacks (e.g., include timestamp or sequence number in M).</p>

                    <h4>Digital Signatures</h4>
                    <p>Provides integrity, authenticity, and <span class="keyword">non-repudiation</span>.</p>
                    <p>Uses asymmetric cryptography:</p>
                    <ul>
                        <li>Sender computes h = H(M).</li>
                        <li>Sender encrypts hash with their <span class="keyword">Private Key</span>: Sig = E(KR<sub>sender</sub>, h).</li>
                        <li>Sender transmits {M, Sig}.</li>
                        <li>Receiver computes h' = H(M').</li>
                        <li>Receiver decrypts signature using sender's <span class="keyword">Public Key</span>: h'' = D(KU<sub>sender</sub>, Sig).</li>
                        <li>Receiver compares h' and h''. If match, message is authentic and intact.</li>
                    </ul>
                    <div class="diagram">
                        <img src="https://via.placeholder.com/700x300.png?text=Digital+Signature+Diagram+(Slide+19a)" alt="Digital Signature Creation and Verification">
                        <figcaption>Digital Signature Creation and Verification</figcaption>
                    </div>

                    <h4>Other Uses</h4>
                    <ul>
                        <li><strong>Password Storage:</strong> Store H(password) instead of password. Compare H(entered_password) with stored hash.</li>
                        <li><strong>Intrusion/Virus Detection:</strong> Store hashes of critical files. Periodically recompute hashes to detect modifications.</li>
                        <li><strong>Pseudorandom Function (PRF) / Number Generator (PRNG):</strong> Hashing can be used to construct PRFs or PRNGs.</li>
                    </ul>
                </div>
             </div>

             <div class="concept-block">
                 <h3 class="concept-header">Secure Hash Algorithm (SHA) Family</h3>
                 <div class="concept-content">
                     <p>Developed by NIST.</p>
                     <ul>
                         <li><strong>SHA-1:</strong> 160-bit hash. Widely used but now considered insecure (collisions found).</li>
                         <li><strong>SHA-2:</strong> Family including SHA-224, SHA-256, SHA-384, SHA-512. Uses Merkle–Damgård structure. Still considered secure. SHA-512 processes 1024-bit message blocks through 80 rounds.</li>
                         <li><strong>SHA-3:</strong> Based on Keccak algorithm and <span class="keyword">Sponge Construction</span>. Different internal structure than SHA-1/SHA-2. Offers similar hash sizes (224, 256, 384, 512) plus extendable output functions (SHAKE).</li>
                     </ul>
                     <div class="diagram">
                         <img src="https://via.placeholder.com/800x400.png?text=SHA-512+Processing+Diagram+(Slide+38)" alt="SHA-512 Message Digest Generation">
                         <figcaption>SHA-512 Message Digest Generation Overview</figcaption>
                     </div>
                 </div>
             </div>

              <div class="concept-block">
                  <h3 class="concept-header">Hashing in Blockchain</h3>
                  <div class="concept-content">
                      <ul>
                          <li>Blockchain is a distributed ledger of blocks linked chronologically.</li>
                          <li>Each block contains data (transactions) and a <span class="keyword">Block Header</span>.</li>
                          <li>Block Header includes: Timestamp, <span class="keyword">Merkle Root</span> (hash of all transactions), <span class="keyword">Nonce</span>, and crucially, the <span class="keyword">Hash of the Previous Block's Header</span>.</li>
                          <li>This previous block hash creates the "chain", ensuring immutability (changing a block invalidates subsequent hashes).</li>
                          <li><span class="keyword">Proof-of-Work (PoW):</span> Miners compete to find a Nonce such that H(Block Header) meets a difficulty target. Requires computational effort, secures the network (e.g., Bitcoin uses double SHA-256).</li>
                          <li><span class="keyword">Proof-of-Stake (PoS):</span> Validators are chosen to create blocks based on staked currency, avoids high energy consumption of PoW.</li>
                          <li><strong>51% Attack:</strong> If an attacker controls >50% of mining power (PoW) or stake (PoS), they can potentially rewrite recent history or double-spend. Harder on large networks.</li>
                      </ul>
                      <div class="diagram">
                          <img src="https://via.placeholder.com/600x300.png?text=Blockchain+Chaining+Diagram+(Slide+50)" alt="Blockchain Hash Chaining">
                          <figcaption>Blocks Linked by Hashes</figcaption>
                      </div>
                  </div>
              </div>


        </section>

        <!-- Quiz Sections -->
        <div id="fill" class="main-content">
            <h2>Fill in the Blank Questions</h2>
            <div id="fill-questions"></div>
        </div>

        <div id="tf" class="main-content">
            <h2>True/False Questions</h2>
            <div id="tf-questions"></div>
        </div>

        <div id="mc" class="main-content">
            <h2>Multiple Choice Questions</h2>
            <div id="mc-questions"></div>
        </div>

    </div> <!-- End Container -->

     <script>
        // --- START OF QUIZ DATA (UNIT 4) ---
        const fillInTheBlank = [
            { question: "A _______ takes an arbitrary size input and produces a fixed-size output called a message digest.", options: ["MAC Algorithm", "Hash Function", "Block Cipher", "Digital Signature"], answer: "Hash Function" },
            { question: "The property that makes it hard to find the original input from a hash output is called the _______ property.", options: ["Collision-free", "Deterministic", "One-way", "Fixed-length"], answer: "One-way" },
            { question: "A _______ occurs when two different inputs produce the same hash output.", options: ["Preimage", "Collision", "Digest", "MAC"], answer: "Collision" },
            { question: "A MAC (Message Authentication Code) combines a message with a secret _______ to produce an authentication tag.", options: ["Hash", "Nonce", "Key", "Certificate"], answer: "Key" },
            { question: "HMAC is a type of MAC based on a _______ function.", options: ["Block Cipher", "Stream Cipher", "Hash", "Public Key"], answer: "Hash" },
            { question: "A Digital Signature uses the sender's _______ key to encrypt the hash of a message.", options: ["Public", "Session", "Symmetric", "Private"], answer: "Private" },
            { question: "SHA-1 produces a _______ -bit hash value.", options: ["128", "160", "256", "512"], answer: "160" },
            { question: "The SHA-3 standard is based on the _______ algorithm.", options: ["MD5", "SHA-2", "Keccak", "AES"], answer: "Keccak" },
            { question: "In blockchain, the _______ links a block to the previous block in the chain.", options: ["Merkle Root", "Nonce", "Previous Block Hash", "Timestamp"], answer: "Previous Block Hash" },
            { question: "The _______ attack exploits the probability of finding hash collisions faster than brute-forcing preimages.", options: ["Man-in-the-middle", "Replay", "Birthday", "Side-channel"], answer: "Birthday" },
            { question: "_______ is the consensus mechanism used by Bitcoin, requiring miners to solve computational puzzles.", options: ["Proof-of-Stake", "Proof-of-Authority", "Proof-of-Work", "Proof-of-Burn"], answer: "Proof-of-Work" },
            { question: "The _______ construction is the iterative structure used in SHA-1 and SHA-2.", options: ["Feistel", "Sponge", "Merkle–Damgård", "Lai–Massey"], answer: "Merkle–Damgård" }
        ];

        const trueOrFalse = [
            { question: "Hash functions require a secret key to operate.", answer: false }, // MACs require a key, basic hashes do not
            { question: "The main purpose of a hash function in cryptography is confidentiality.", answer: false }, // Main purpose is integrity
            { question: "A MAC provides both data integrity and message authentication.", answer: true },
            { question: "Digital signatures use the recipient's public key for signing.", answer: false }, // Uses sender's private key
            { question: "SHA-1 is currently considered secure for all applications.", answer: false }, // Considered broken due to collision attacks
            { question: "SHA-3 has the same internal structure as SHA-2.", answer: false }, // SHA-3 uses Sponge, SHA-2 uses Merkle-Damgard
            { question: "Finding a preimage for a secure hash function is computationally easy.", answer: false }, // It's computationally infeasible (one-way property)
            { question: "A birthday attack aims to find the private key from a public key.", answer: false }, // Aims to find collisions in hash functions
            { question: "In blockchain, changing data in one block will invalidate the hashes of all subsequent blocks.", answer: true },
            { question: "Proof-of-Stake requires miners to perform intensive computations.", answer: false }, // Proof-of-Work does; PoS relies on staked assets
            { question: "HMAC is a cipher-based Message Authentication Code.", answer: false }, // It's hash-based
            { question: "A message digest is typically much shorter than the original message.", answer: true } // It's fixed-size, input can be arbitrary
        ];

        const multipleChoice = [
            { question: "Which is NOT a primary goal of authentication?", options: ["Verify sender identity", "Ensure message integrity", "Ensure message confidentiality", "Prevent replay attacks"], answer: "Ensure message confidentiality" },
            { question: "Which property ensures it's hard to find two different messages M1 and M2 such that H(M1) = H(M2)?", options: ["One-way property", "Preimage resistance", "Collision resistance", "Fixed output size"], answer: "Collision resistance" },
            { question: "What does a Message Authentication Code (MAC) require that a simple hash function does not?", options: ["A fixed-size output", "A variable-size input", "A secret key", "A one-way function"], answer: "A secret key" },
            { question: "A digital signature provides authentication, integrity, and which other property?", options: ["Confidentiality", "Availability", "Non-repudiation", "Anonymity"], answer: "Non-repudiation" },
            { question: "Which SHA algorithm family uses the Sponge construction?", options: ["SHA-0", "SHA-1", "SHA-2", "SHA-3"], answer: "SHA-3" },
            { question: "Which attack becomes significantly easier due to the 'Birthday Problem' in probability?", options: ["Finding Preimages", "Finding Collisions", "Brute-forcing keys", "Side-channel attacks"], answer: "Finding Collisions" },
            { question: "What element in a blockchain block header ensures the chain's integrity by linking to the prior block?", options: ["Timestamp", "Nonce", "Merkle Root", "Previous Block Hash"], answer: "Previous Block Hash" },
            { question: "Which algorithm is used to create a MAC using a block cipher like AES?", options: ["HMAC", "CMAC", "SHA-256", "Keccak"], answer: "CMAC" },
            { question: "For a 256-bit hash function, approximately how many hashes need to be computed to find a collision via a Birthday Attack?", options: ["2^256", "2^255", "2^128", "2^64"], answer: "2^128" }, // 2^(n/2)
            { question: "What is the primary role of the 'Nonce' in a Proof-of-Work blockchain?", options: ["Timestamping the block", "Storing transaction data", "Linking to the previous block", "A variable changed by miners to find a valid hash"], answer: "A variable changed by miners to find a valid hash" },
            { question: "Which of these hash functions is considered broken and should not be used?", options: ["SHA-256", "SHA-512", "SHA-1", "SHA-3"], answer: "SHA-1" },
            { question: "How is authenticity primarily verified using a digital signature?", options: ["Encrypting the message with sender's private key", "Decrypting the signature with sender's public key", "Comparing the hash of the message", "Checking a shared secret key"], answer: "Decrypting the signature with sender's public key" } // And comparing the result with the re-calculated hash
        ];
        // --- END OF QUIZ DATA ---

        // --- START OF SCRIPT LOGIC (PASTE FROM previous units) ---
        document.addEventListener('DOMContentLoaded', () => {
            // Select main tabs and content sections
            const mainTabButtons = document.querySelectorAll('.main-tabs .tab-button');
            const mainTabContents = document.querySelectorAll('.main-content');

            // Select quiz content containers
            const fillContainer = document.getElementById('fill-questions');
            const tfContainer = document.getElementById('tf-questions');
            const mcContainer = document.getElementById('mc-questions');

             // Select accordion elements (Glossary)
            const glossaryAccordionHeaders = document.querySelectorAll('.glossary-accordion .accordion-header');

            // Select accordion elements (Key Concepts) - NEW
            const conceptAccordionHeaders = document.querySelectorAll('#concepts .concept-header');


            // --- Main Tab Switching Logic ---
            mainTabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab'); // Get the ID of the target content

                    // Deactivate all main buttons and content
                    mainTabButtons.forEach(btn => btn.classList.remove('active'));
                    mainTabContents.forEach(content => {
                        content.classList.remove('active');
                        // Ensure non-active tabs are hidden (redundant if CSS handles .active correctly, but safe)
                        content.style.display = 'none';
                    });

                    // Activate the clicked button
                    button.classList.add('active');

                    // Activate the corresponding content section
                    const targetContent = document.getElementById(tabId);
                    if (targetContent) {
                        targetContent.classList.add('active');
                        // Ensure active tab is displayed
                        targetContent.style.display = 'block';
                    }
                });
            });

            // --- Accordion Logic (for Glossary) ---
             glossaryAccordionHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    // Toggle active class on the header for styling (+) (-) sign
                    this.classList.toggle('active');

                    // Get the panel sibling
                    const panel = this.nextElementSibling;

                    // Toggle the max-height for smooth transition
                    if (panel.style.maxHeight) {
                        // If panel is open, close it
                        panel.style.maxHeight = null;
                        panel.style.padding = "0 20px"; // Remove padding when closing
                    } else {
                         // If panel is closed, open it
                        panel.style.maxHeight = panel.scrollHeight + 40 + "px"; // Add some buffer
                        panel.style.padding = "15px 20px"; // Add padding back when opening
                    }

                    // --- Optional: Close other accordions ---
                    glossaryAccordionHeaders.forEach(otherHeader => {
                        if (otherHeader !== this && otherHeader.classList.contains('active')) {
                            otherHeader.classList.remove('active');
                            otherHeader.nextElementSibling.style.maxHeight = null;
                            otherHeader.nextElementSibling.style.padding = "0 20px";
                        }
                    });
                    // --- End Optional Close Others ---
                });
            });

            // --- Accordion Logic (for Key Concepts) - NEW ---
            conceptAccordionHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    // Toggle active class on the header
                    this.classList.toggle('active');

                    // Get the content panel sibling
                    const panel = this.nextElementSibling; // Assumes .concept-content is immediately after .concept-header

                    // Toggle the max-height for smooth transition
                    if (panel.style.maxHeight) {
                        // If panel is open, close it
                        panel.style.maxHeight = null;
                        panel.style.padding = "0 20px"; // Adjust padding on close
                    } else {
                        // If panel is closed, open it
                        // Need to calculate scrollHeight *after* setting display potentially
                        panel.style.maxHeight = panel.scrollHeight + 40 + "px"; // Add buffer for margins/padding inside
                        panel.style.padding = "1px 20px"; // Add padding back (use 1px top/bottom to avoid margin collapse issues if needed, then adjust margins inside)
                        // Re-apply top/bottom padding after transition starts or use internal margins
                         setTimeout(() => { // Ensure padding is applied correctly with transition
                             panel.style.padding = "1px 20px"; // Keep this simple, rely on internal element margins set in CSS
                         }, 5); // Small delay
                    }

                    // --- Optional: Close other concept accordions ---
                    conceptAccordionHeaders.forEach(otherHeader => {
                        if (otherHeader !== this && otherHeader.classList.contains('active')) {
                            otherHeader.classList.remove('active');
                            const otherPanel = otherHeader.nextElementSibling;
                            otherPanel.style.maxHeight = null;
                            otherPanel.style.padding = "0 20px";
                        }
                    });
                    // --- End Optional Close Others ---
                });
            });


            // --- Function to handle option selection within a question ---
            // ... existing handleOptionSelection function ...
            function handleOptionSelection(button, questionDiv) {
                // Deselect siblings within the same question
                const siblings = questionDiv.querySelectorAll('.option-button.selected');
                siblings.forEach(sib => sib.classList.remove('selected'));
                // Select clicked button
                button.classList.add('selected');
                 // Clear previous feedback when a new option is selected
                const existingFeedback = questionDiv.querySelector('.feedback');
                if (existingFeedback) {
                    existingFeedback.remove();
                }
            }


            // --- Function to create and append feedback ---
            // ... existing showFeedback function ...
            function showFeedback(questionDiv, isCorrect, correctAnswer) {
                 // Remove existing feedback first
                const existingFeedback = questionDiv.querySelector('.feedback');
                if (existingFeedback) {
                    existingFeedback.remove();
                }

                const feedback = document.createElement('div');
                feedback.className = 'feedback';
                if (isCorrect) {
                    feedback.classList.add('correct');
                    feedback.textContent = 'Correct!';
                } else {
                    feedback.classList.add('incorrect');
                     // For T/F, explicitly show the boolean value
                     let displayAnswer = correctAnswer;
                     if (typeof correctAnswer === 'boolean') {
                         displayAnswer = correctAnswer ? 'True' : 'False';
                     }
                    feedback.textContent = `Incorrect. Correct answer: ${displayAnswer}`;
                }
                // Append feedback after the check button
                const checkButton = questionDiv.querySelector('.check-answer');
                 if (checkButton) {
                    // Insert after the check button if it exists
                    checkButton.parentNode.insertBefore(feedback, checkButton.nextSibling);
                } else {
                     // Otherwise, append to the end of the question div
                     questionDiv.appendChild(feedback);
                }
            }


            // --- Load Fill in the Blank Questions ---
            // ... existing loadFillInTheBlankQuestions function ...
            function loadFillInTheBlankQuestions() {
                fillContainer.innerHTML = ''; // Clear previous content
                fillInTheBlank.forEach((q, index) => { // Added index for unique IDs if needed
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question';
                    questionDiv.id = `fill-q-${index}`;

                    const questionText = document.createElement('p');
                    // Find the blank spot indicated by _______ and replace it for display
                    questionText.innerHTML = q.question.replace('_______', '<span style="color: #007bff; font-weight:bold;">_______</span>');
                    questionDiv.appendChild(questionText);

                    const optionsDiv = document.createElement('div');
                    optionsDiv.className = 'options';

                    q.options.forEach(option => {
                        const optionButton = document.createElement('button');
                        optionButton.className = 'option-button';
                        optionButton.textContent = option;
                        optionButton.addEventListener('click', () => handleOptionSelection(optionButton, questionDiv));
                        optionsDiv.appendChild(optionButton);
                    });
                    questionDiv.appendChild(optionsDiv);

                    const checkButton = document.createElement('button');
                    checkButton.className = 'check-answer';
                    checkButton.textContent = 'Check Answer';
                    checkButton.addEventListener('click', () => {
                        const selected = questionDiv.querySelector('.option-button.selected');
                        if (selected) {
                            showFeedback(questionDiv, selected.textContent === q.answer, q.answer);
                        } else {
                             // Optionally show feedback that an answer must be selected
                             showFeedback(questionDiv, false, q.answer); // Or provide specific feedback
                        }
                    });
                    questionDiv.appendChild(checkButton);

                    fillContainer.appendChild(questionDiv);
                });
            }


            // --- Load True/False Questions ---
            // ... existing loadTrueFalseQuestions function ...
            function loadTrueFalseQuestions() {
                tfContainer.innerHTML = ''; // Clear previous content
                trueOrFalse.forEach((q, index) => { // Added index
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question';
                    questionDiv.id = `tf-q-${index}`;

                    const questionText = document.createElement('p');
                    questionText.textContent = q.question;
                    questionDiv.appendChild(questionText);

                     const optionsDiv = document.createElement('div'); // Keep consistent structure
                    optionsDiv.className = 'options';

                    const trueButton = document.createElement('button');
                    trueButton.className = 'option-button';
                    trueButton.textContent = 'True';
                    trueButton.addEventListener('click', () => handleOptionSelection(trueButton, questionDiv));
                    optionsDiv.appendChild(trueButton);

                    const falseButton = document.createElement('button');
                    falseButton.className = 'option-button';
                    falseButton.textContent = 'False';
                    falseButton.addEventListener('click', () => handleOptionSelection(falseButton, questionDiv));
                    optionsDiv.appendChild(falseButton);

                    questionDiv.appendChild(optionsDiv);

                    const checkButton = document.createElement('button');
                    checkButton.className = 'check-answer';
                    checkButton.textContent = 'Check Answer';
                    checkButton.addEventListener('click', () => {
                        const selected = questionDiv.querySelector('.option-button.selected');
                        if (selected) {
                            // Check boolean answer correctly
                            const isCorrect = (selected.textContent === 'True' && q.answer === true) || (selected.textContent === 'False' && q.answer === false);
                            showFeedback(questionDiv, isCorrect, q.answer); // Pass boolean directly
                        } else {
                            showFeedback(questionDiv, false, q.answer); // Pass boolean directly
                        }
                    });
                    questionDiv.appendChild(checkButton);

                    tfContainer.appendChild(questionDiv);
                });
            }


            // --- Load Multiple Choice Questions ---
            // ... existing loadMultipleChoiceQuestions function ...
            function loadMultipleChoiceQuestions() {
                mcContainer.innerHTML = ''; // Clear previous content
                multipleChoice.forEach((q, index) => { // Added index
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question';
                    questionDiv.id = `mc-q-${index}`;

                    const questionText = document.createElement('p');
                    questionText.textContent = q.question;
                    questionDiv.appendChild(questionText);

                    const optionsDiv = document.createElement('div');
                    optionsDiv.className = 'options';

                    // Shuffle options for variety (optional)
                    // const shuffledOptions = [...q.options].sort(() => Math.random() - 0.5);

                    q.options.forEach(option => { // Use original options or shuffledOptions
                        const optionButton = document.createElement('button');
                        optionButton.className = 'option-button';
                        optionButton.textContent = option;
                        optionButton.addEventListener('click', () => handleOptionSelection(optionButton, questionDiv));
                        optionsDiv.appendChild(optionButton);
                    });
                    questionDiv.appendChild(optionsDiv);

                    const checkButton = document.createElement('button');
                    checkButton.className = 'check-answer';
                    checkButton.textContent = 'Check Answer';
                    checkButton.addEventListener('click', () => {
                        const selected = questionDiv.querySelector('.option-button.selected');
                        if (selected) {
                            showFeedback(questionDiv, selected.textContent === q.answer, q.answer);
                        } else {
                             showFeedback(questionDiv, false, q.answer);
                        }
                    });
                    questionDiv.appendChild(checkButton);

                    mcContainer.appendChild(questionDiv);
                });
            }


            // --- Initial Load ---
            // Load all quiz questions initially so they are ready when tabs are clicked
            loadFillInTheBlankQuestions();
            loadTrueFalseQuestions();
            loadMultipleChoiceQuestions();

             // Activate the default tab's content on load and hide others
             mainTabContents.forEach(content => {
                 if (content.classList.contains('active')) {
                     content.style.display = 'block';
                 } else {
                     content.style.display = 'none';
                 }
             });


        }); // End DOMContentLoaded
        // --- END OF SCRIPT LOGIC ---
    </script>
</body>
</html>

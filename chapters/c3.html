<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SE205 - Unit 3: Asymmetric Cryptography</title>
    <style>
        /* Paste the CSS from the SE205 unit1.html / unit2.html example here */
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 30px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        h1, h2, h3, h4 { /* Added h4 */
            color: #0056b3; /* Cairo University Blue */
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #dee2e6;
            padding-bottom: 15px;
        }

        h2 {
            margin-top: 20px;
            margin-bottom: 20px;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 10px;
        }

        h3 {
            margin-top: 25px;
            margin-bottom: 15px;
            color: #007bff; /* Lighter Blue */
        }
        h4 { /* Style for sub-sections within concepts */
             margin-top: 20px;
             margin-bottom: 10px;
             color: #17a2b8; /* Info Blue */
        }

         ul {
            list-style-type: disc;
            padding-left: 20px;
            margin-top: 10px;
        }
         li {
             margin-bottom: 8px;
         }
         ol { /* Style ordered lists too */
             padding-left: 25px;
             margin-top: 10px;
         }
        code, pre { /* Apply styling to pre for code blocks */
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            background-color: #e9ecef;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.95em;
            display: block; /* Make pre block-level */
            overflow-x: auto; /* Add scroll for long code lines */
            padding: 10px; /* More padding for pre */
            margin-top: 10px;
            margin-bottom: 10px;
            border: 1px solid #dee2e6;
        }
        strong { /* Use default strong for emphasis, specific class for keywords */
             /*color: #dc3545; */ /* Red emphasis */
        }
        .keyword { /* Class for highlighting keywords */
            font-weight: bold;
            color: #dc3545; /* Red */
        }
         .formula { /* Specific style for formula display */
            font-weight: bold;
            color: #28a745; /* Green */
            margin: 10px 0;
            padding: 5px;
            background-color: #f0fff0;
            border-left: 3px solid #28a745;
         }
         .example {
             margin-top: 15px;
             padding-left: 15px;
             border-left: 3px solid #17a2b8; /* Info Blue */
             background-color: #f8f9fa;
             padding: 15px;
             border-radius: 4px;
         }
          .solution {
             margin-top: 10px;
             padding-left: 15px;
             font-style: italic;
             color: #555;
         }
         .solution code, .solution pre {
            font-style: normal; /* Keep code normal style */
            background-color: #e0e0e0; /* Slightly darker bg for solution code */
         }

        /* Main Tabs Styles */
        .main-tabs {
            display: flex;
            justify-content: space-around; /* Or flex-start, center */
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
            margin-bottom: 25px;
            border-bottom: 2px solid #0056b3;
        }

        .main-tabs .tab-button {
            padding: 12px 20px; /* Adjusted padding slightly */
            border: none;
            background: none;
            color: #0056b3;
            font-size: 0.95em; /* Slightly smaller font */
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
            transition: background-color 0.3s ease, color 0.3s ease;
            margin-bottom: -2px; /* Overlap border */
            border-bottom: 2px solid transparent;
            text-align: center;
        }

        .main-tabs .tab-button.active {
            background: #0056b3;
            color: white;
            border-bottom: 2px solid #0056b3;
        }
        .main-tabs .tab-button:hover:not(.active) {
            background-color: #e9ecef;
            border-bottom: 2px solid #adb5bd;
        }

        /* Content Sections */
        .main-content {
            display: none; /* Hide all main content sections by default */
            animation: fadeIn 0.5s;
        }

        .main-content.active {
            display: block; /* Show only the active one */
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }


        /* --- Accordion Styles (for Glossary) --- */
        .glossary-accordion {
            border: 1px solid #dee2e6;
            border-radius: 5px;
            overflow: hidden; /* Contain borders */
        }

        .accordion-item {
            border-bottom: 1px solid #dee2e6; /* Separator */
        }
        .accordion-item:last-child {
            border-bottom: none;
        }

        .accordion-header {
            background-color: #f8f9fa;
            color: #dc3545; /* Highlight Red for terms */
            cursor: pointer;
            padding: 15px 20px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s ease;
            position: relative; /* For the indicator */
        }

        .accordion-header:hover {
            background-color: #e9ecef;
        }

        /* Indicator (+/-) */
        .accordion-header::after {
            content: '\002B'; /* + sign */
            color: #0056b3;
            font-weight: bold;
            float: right;
            margin-left: 5px;
            transition: transform 0.2s ease-in-out;
        }

        .accordion-header.active::after {
            content: "\2212"; /* - sign */
            transform: rotate(180deg); /* Optional: animate the sign itself */
        }
        /* Optional: Slightly different style for active header */
        .accordion-header.active {
             background-color: #e7f1ff;
        }


        .accordion-panel {
            padding: 0 20px; /* Start with 0 padding top/bottom */
            background-color: white;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out; /* Smooth transition */
        }
        .accordion-panel p, .accordion-panel ul { /* Apply margin to lists too */
            margin: 15px 0; /* Add margin back when panel is open */
            color: #333; /* Reset color for definition */
        }
        .accordion-panel pre { /* Style code blocks inside accordion */
             margin: 15px 0;
             background-color: #f1f1f1;
        }

        /* --- End Accordion Styles --- */

        /* Concepts Section Styles */
        #concepts .concept-block {
            background-color: #ffffff; /* White background for concept blocks */
            border: 1px solid #e9ecef;
            /* padding: 20px; */ /* Remove padding here, apply to panel */
            border-radius: 5px;
            margin-bottom: 25px;
             box-shadow: 0 2px 4px rgba(0,0,0,0.05);
             overflow: hidden; /* Contain borders for header/panel */
        }
         /* #concepts .concept-block h3 { */ /* Style .concept-header instead */
            /* margin-top: 0;
            color: #007bff;
            border-bottom: 1px dotted #ccc;
            padding-bottom: 8px;
            margin-bottom: 15px; */
        /* } */

        /* --- Concept Accordion Styles --- */
        .concept-header {
            background-color: #e7f1ff; /* Light blue background */
            color: #0056b3; /* Darker blue text */
            cursor: pointer;
            padding: 15px 20px;
            width: 100%;
            border: none;
            border-bottom: 1px solid #dee2e6; /* Separator line */
            text-align: left;
            outline: none;
            font-size: 1.2em; /* Make concept titles slightly larger */
            font-weight: bold;
            transition: background-color 0.3s ease;
            position: relative; /* For the indicator */
            margin: 0; /* Remove default h3 margin */
        }
        .concept-header:hover {
            background-color: #d0e1f9; /* Slightly darker blue on hover */
        }
        .concept-header::after {
            content: '\002B'; /* + sign */
            color: #0056b3;
            font-weight: bold;
            float: right;
            margin-left: 5px;
            transition: transform 0.2s ease-in-out;
        }
        .concept-header.active::after {
            content: "\2212"; /* - sign */
            /* transform: rotate(180deg); */ /* Optional rotation */
        }
        .concept-header.active {
             background-color: #c0d6f3; /* Even darker when active */
             border-bottom-color: transparent; /* Hide border when open */
        }
        .concept-panel {
            padding: 0 20px; /* Start with 0 padding top/bottom */
            background-color: white;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out; /* Smooth transition */
            border-bottom: 1px solid #dee2e6; /* Add border to bottom of panel */
        }
         .concept-panel > *:first-child {
             margin-top: 15px; /* Add margin to first element inside panel */
         }
         .concept-panel > *:last-child {
             margin-bottom: 15px; /* Add margin to last element inside panel */
         }
        /* --- End Concept Accordion Styles --- */


        /* Quiz Styles (apply within #fill, #tf, #mc) */
        .question {
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            background-color: #ffffff; /* White background for questions */
            position: relative; /* For feedback positioning */
        }

        .question p {
            margin: 0 0 15px;
            font-weight: bold;
            font-size: 1.05em;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-button {
            padding: 10px 15px;
            border: 1px solid #ced4da;
            background: #f8f9fa; /* Light background for options */
            color: #495057;
            cursor: pointer;
            border-radius: 5px;
            text-align: left;
            transition: background-color 0.2s ease, border-color 0.2s ease;
            width: 100%;
        }
        .option-button:hover {
             background-color: #e9ecef;
             border-color: #adb5bd;
        }

        .option-button.selected {
            background: #007bff;
            color: white;
            border-color: #0056b3;
        }

        .check-answer {
            margin-top: 15px;
            padding: 10px 20px;
            border: none;
            background: #28a745; /* Success Green */
            color: white;
            cursor: pointer;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.2s ease;
        }
        .check-answer:hover {
             background-color: #218838;
        }

        .feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>SE205 - Unit 3: Asymmetric Cryptography</h1>

        <!-- Main Tab Buttons -->
        <div class="main-tabs">
            <button class="tab-button active" data-tab="glossary">Glossary</button>
            <button class="tab-button" data-tab="concepts">Key Concepts & Examples</button>
            <button class="tab-button" data-tab="fill">Fill in the Blank</button>
            <button class="tab-button" data-tab="tf">True/False</button>
            <button class="tab-button" data-tab="mc">Multiple Choice</button>
        </div>

        <!-- Glossary Section (Accordion) -->
        <section id="glossary" class="main-content active">
            <h2>Glossary of Terms</h2>
            <div class="glossary-accordion">
                 <div class="accordion-item">
                    <button class="accordion-header">Asymmetric Cryptography</button>
                    <div class="accordion-panel">
                        <p>A cryptographic system that uses pairs of keys: public keys which may be disseminated widely, and private keys which are known only to the owner. Also known as Public-Key Cryptography. Enables encryption, digital signatures, and key exchange without pre-sharing a secret key.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Block Cipher</button>
                    <div class="accordion-panel">
                        <p>An encryption algorithm that operates on fixed-length groups of bits, called blocks. Asymmetric algorithms like RSA operate mathematically on integers representing blocks.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">Brute-force attack (Public Key)</button>
                    <div class="accordion-panel">
                        <p>Trying all possible private keys. Countered by using very large key sizes (e.g., 2048 bits or more for RSA).</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">Diffie-Hellman Key Exchange</button>
                    <div class="accordion-panel">
                        <p>An asymmetric protocol used to establish a shared secret (symmetric key) between two parties over an insecure channel. It does not encrypt messages itself but enables secure key establishment.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Digital Signature</button>
                    <div class="accordion-panel">
                        <p>An application of asymmetric cryptography used to verify the authenticity and integrity of a message. The sender signs (encrypts a hash of the message) with their private key, and anyone can verify using the sender's public key.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">DSS (Digital Signature Standard)</button>
                    <div class="accordion-panel">
                        <p>A U.S. federal standard for digital signatures based on the Digital Signature Algorithm (DSA), which is an asymmetric algorithm but cannot be used for encryption, only signing.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">ECC (Elliptic Curve Cryptography)</button>
                    <div class="accordion-panel">
                        <p>An approach to public-key cryptography based on the algebraic structure of elliptic curves over finite fields. Provides equivalent security to RSA with much smaller key sizes, leading to better performance.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">ElGamal Cryptosystem</button>
                    <div class="accordion-panel">
                        <p>An asymmetric key encryption algorithm based on the Diffie-Hellman key exchange, using the difficulty of the discrete logarithm problem. Can be used for both encryption and digital signatures.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Encryption/Decryption (Asymmetric)</button>
                    <div class="accordion-panel">
                        <p>To send a confidential message, the sender encrypts it using the recipient's public key. Only the recipient, with their corresponding private key, can decrypt the message.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Euler's Totient Function (φ(n))</button>
                    <div class="accordion-panel">
                        <p>In number theory, for a positive integer n, the totient φ(n) is the number of positive integers less than or equal to n that are relatively prime to n (i.e., share no common factors other than 1). For RSA, if n = p*q (p, q are prime), then φ(n) = (p-1)*(q-1).</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">Integer</button>
                    <div class="accordion-panel">
                        <p>A whole number (not a fraction). In RSA, the plaintext and ciphertext are treated as large integers for mathematical operations.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Key Exchange</button>
                    <div class="accordion-panel">
                        <p>An application of asymmetric cryptography where two parties cooperate to securely establish a shared secret key (typically a symmetric key for later bulk encryption) over an insecure channel. Examples: Diffie-Hellman, RSA key transport.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Modular Arithmetic</button>
                    <div class="accordion-panel">
                        <p>A system of arithmetic for integers, where numbers "wrap around" upon reaching a certain value—the modulus. Operations like 'mod n' find the remainder after division by n. Central to RSA and Diffie-Hellman.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">One-way function</button>
                    <div class="accordion-panel">
                        <p>A mathematical function that is easy to compute in one direction (e.g., encrypting with a public key) but computationally infeasible to reverse (e.g., decrypting without the private key, or finding the private key from the public key).</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">PGP (Pretty Good Privacy)</button>
                    <div class="accordion-panel">
                        <p>An encryption program that provides cryptographic privacy and authentication for data communication. PGP is often used for signing, encrypting, and decrypting texts, e-mails, files, directories, and whole disk partitions and to increase the security of e-mail communications. It typically uses a hybrid approach (asymmetric for key exchange/signing, symmetric for bulk encryption).</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Prime Number</button>
                    <div class="accordion-panel">
                        <p>A natural number greater than 1 that has no positive divisors other than 1 and itself. The security of RSA relies on the difficulty of factoring the product of two large prime numbers.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Private Key</button>
                    <div class="accordion-panel">
                        <p>In asymmetric cryptography, the key of the key pair that is kept secret by the owner. Used for decryption (in public-key encryption) or signing (in digital signatures).</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Public Key</button>
                    <div class="accordion-panel">
                        <p>In asymmetric cryptography, the key of the key pair that can be shared openly. Used for encryption (in public-key encryption) or verifying signatures (in digital signatures).</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Public Key Cryptography</button>
                    <div class="accordion-panel">
                        <p>See Asymmetric Cryptography.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Relatively Prime</button>
                    <div class="accordion-panel">
                        <p>Two integers are relatively prime (or coprime) if their greatest common divisor (GCD) is 1. In RSA, the public exponent 'e' must be relatively prime to φ(n).</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">RSA Algorithm</button>
                    <div class="accordion-panel">
                        <p>A widely used public-key cryptosystem for secure data transmission. Named after its inventors Rivest, Shamir, and Adleman. Can be used for both encryption and digital signatures.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">Session Key</button>
                    <div class="accordion-panel">
                        <p>A symmetric key used for encrypting messages during a single communication session only. Often established using an asymmetric key exchange method like Diffie-Hellman or RSA.</p>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">Side-channel attack</button>
                    <div class="accordion-panel">
                        <p>An attack based on information gained from the physical implementation of a cryptosystem, rather than theoretical weaknesses. Examples include timing analysis, power monitoring, or electromagnetic leaks. RSA can be vulnerable if not implemented carefully.</p>
                    </div>
                </div>

            </div> <!-- End glossary-accordion -->
        </section>

        <!-- Key Concepts & Examples Section -->
        <section id="concepts" class="main-content">
            <h2>Key Concepts & Examples from Unit 3</h2>

             <div class="concept-block">
                <h3 class="concept-header">Asymmetric (Public-Key) Cryptography Principles</h3>
                <div class="concept-panel">
                    <p>Based on mathematical functions rather than simple substitution/permutation.</p>
                    <ul>
                        <li>Uses two separate, mathematically related keys:
                            <ul>
                                <li><span class="keyword">Public Key:</span> Shared openly, used for encryption or signature verification.</li>
                                <li><span class="keyword">Private Key:</span> Kept secret, used for decryption or signature creation.</li>
                            </ul>
                        </li>
                        <li><span class="keyword">Key Principle:</span> Data encrypted with one key can only be decrypted with the other key in the pair.</li>
                        <li>Relies on <span class="keyword">one-way functions:</span> easy to compute forward (encrypt), computationally infeasible to reverse without the private key.</li>
                        <li>Essential Steps:
                            <ol>
                                <li><strong>Key Generation:</strong> Each party generates a public/private key pair.</li>
                                <li><strong>Key Exchange:</strong> Parties exchange *public* keys (private keys are never shared).</li>
                                <li><strong>Encryption:</strong> Sender encrypts data using the *recipient's* public key.</li>
                                <li><strong>Sending:</strong> Encrypted data transmitted over insecure channel.</li>
                                <li><strong>Decryption:</strong> Recipient decrypts data using their *own* private key.</li>
                            </ol>
                        </li>
                         <li><strong>Applications:</strong>
                            <ul>
                                <li><span class="keyword">Encryption/Decryption:</span> Sender encrypts with recipient's public key (Confidentiality).</li>
                                 <li><span class="keyword">Digital Signature:</span> Sender signs (encrypts hash) with their private key (Authentication, Integrity, Non-repudiation).</li>
                                <li><span class="keyword">Key Exchange:</span> Establish a shared symmetric (session) key (e.g., Diffie-Hellman).</li>
                            </ul>
                         </li>
                    </ul>
                     <p><strong>Comparison: Symmetric vs. Asymmetric</strong> (See slide 15 for table)</p>
                     <ul>
                         <li><strong>Speed:</strong> Symmetric is much faster.</li>
                         <li><strong>Key Management:</strong> Asymmetric simplifies distribution (only public keys shared), Symmetric requires secure channel for shared key.</li>
                         <li><strong>Use Cases:</strong> Symmetric for bulk data encryption (files, VPNs), Asymmetric for key exchange, digital signatures, authentication (SSL/TLS, PGP).</li>
                        <li><strong>Security (Key Length):</strong> Asymmetric keys need to be much longer for equivalent security (e.g., 3072-bit RSA ≈ 256-bit AES).</li>
                     </ul>
                      <p><strong>Common Practice (Hybrid Approach):</strong> Use asymmetric crypto to securely exchange a symmetric session key, then use the faster symmetric crypto for bulk data encryption (e.g., SSL/TLS, PGP).</p>
                </div> <!-- End concept-panel -->
            </div> <!-- End concept-block -->

             <div class="concept-block">
                 <h3 class="concept-header">RSA Algorithm (Rivest, Shamir, Adleman)</h3>
                 <div class="concept-panel">
                     <p>Most widely used public-key algorithm. Can be used for encryption and digital signatures.</p>
                     <h4>RSA Key Generation Steps</h4>
                     <ol>
                         <li><strong>Select two large distinct prime numbers, <var>p</var> and <var>q</var>.</strong> (Must be kept secret).</li>
                         <li><strong>Calculate modulus <var>n</var> = <var>p</var> * <var>q</var>.</strong> (<var>n</var> is part of the public/private key, its bit length determines key size).</li>
                         <li><strong>Calculate Euler's Totient Function: φ(<var>n</var>) = (<var>p</var>-1) * (<var>q</var>-1).</strong> (Must be kept secret).</li>
                         <li><strong>Choose public exponent <var>e</var> such that:</strong>
                             <ul>
                                 <li>1 < <var>e</var> < φ(<var>n</var>)</li>
                                 <li><var>e</var> and φ(<var>n</var>) are relatively prime (gcd(<var>e</var>, φ(<var>n</var>)) = 1). (Common values are 3, 65537).</li>
                             </ul>
                         </li>
                         <li><strong>Calculate private exponent <var>d</var> such that:</strong>
                             <ul>
                                  <li>(<var>d</var> * <var>e</var>) mod φ(<var>n</var>) = 1. (i.e., <var>d</var> is the modular multiplicative inverse of <var>e</var> modulo φ(<var>n</var>)).</li>
                             </ul>
                         </li>
                         <li><strong>Public Key: KU = {<var>e</var>, <var>n</var>}</strong></li>
                         <li><strong>Private Key: KR = {<var>d</var>, <var>n</var>}</strong></li>
                     </ol>
                     <h4>RSA Encryption/Decryption</h4>
                     <p>Plaintext M and Ciphertext C are integers (M < n).</p>
                     <p class="formula">Encryption: C = M<sup>e</sup> mod n</p>
                     <p class="formula">Decryption: M = C<sup>d</sup> mod n</p>

                     <div class="example">
                         <p><strong>RSA Example (from slide 26-27):</strong></p>
                         <ol>
                            <li>Select p = 13, q = 11.</li>
                            <li>Calculate n = p * q = 13 * 11 = 143.</li>
                            <li>Calculate φ(n) = (p-1)*(q-1) = (12)*(10) = 120.</li>
                            <li>Choose e = 13 (Check: 1 < 13 < 120, gcd(13, 120)=1. OK).</li>
                            <li>Calculate d such that (d * 13) mod 120 = 1.
                                <ul><li>Using Extended Euclidean Algorithm or trial: d = ((φ(n) * i) + 1) / e</li>
                                    <li>i=1: (120*1+1)/13 = 9.30</li>
                                    <li>i=2: (120*2+1)/13 = 18.53</li>
                                    <li>i=3: (120*3+1)/13 = 27.76</li>
                                    <li>i=4: (120*4+1)/13 = 481 / 13 = 37. <strong>So, d = 37</strong>.</li>
                                 </ul>
                             </li>
                             <li>Public Key KU = {13, 143}.</li>
                             <li>Private Key KR = {37, 143}.</li>
                         </ol>
                         <p><strong>Encryption Example:</strong> Plaintext M = 13.</p>
                         <p class="formula">C = M<sup>e</sup> mod n = 13<sup>13</sup> mod 143</p>
                         <p><em>(Calculation requires modular exponentiation)</em></p>
                         <div class="solution"><strong>Ciphertext C = 52</strong> (as per slide)</div>
                         <p><strong>Decryption Example:</strong> Ciphertext C = 52.</p>
                          <p class="formula">M = C<sup>d</sup> mod n = 52<sup>37</sup> mod 143</p>
                         <div class="solution"><strong>Plaintext M = 13</strong> (as per slide)</div>
                     </div>

                     <div class="example">
                          <p><strong>Exercise 1 (Slide 28):</strong> p=7, q=17, e=5. Encrypt M=? (Need M). Decrypt C=? (Need C). Let's find keys first.</p>
                          <p>n = 7 * 17 = 119</p>
                          <p>φ(n) = (7-1)*(17-1) = 6 * 16 = 96</p>
                          <p>e = 5 (Given, gcd(5, 96)=1)</p>
                          <p>Find d: (d * 5) mod 96 = 1. (96*i + 1) / 5</p>
                          <p>i=1: 97/5 X, i=2: 193/5 X, i=3: 289/5 X, i=4: 385/5 = 77. <strong>d = 77</strong>.</p>
                          <p>Public Key = {5, 119}, Private Key = {77, 119}.</p>
                           <p><em>Slide encrypts M=6:</em> C = 6<sup>5</sup> mod 119 = 7776 mod 119. 7776 / 119 = 65.34... 7776 - 65*119 = 7776 - 7735 = 41. <strong>C = 41</strong>.</p>
                           <p><em>Slide decrypts C=41:</em> M = 41<sup>77</sup> mod 119. (Requires modular exponentiation). <strong>M = 6</strong>.</p>
                           <div class="solution">Keys: KU={5, 119}, KR={77, 119}. If M=6, C=41. If C=41, M=6.</div>
                     </div>
                     <!-- Add Exercises 2 and 3 similarly -->

                      <h4>RSA Pros & Cons</h4>
                     <ul>
                         <li><strong>Advantages:</strong> Very secure (if key is large), Public-key mechanism (key exchange, digital sig), Widely used standard.</li>
                         <li><strong>Disadvantages:</strong> Slow processing speed, Requires large key sizes (computationally expensive), Vulnerable to side-channel attacks (implementation issue), Vulnerable to quantum computing (future threat), Key management of private key critical.</li>
                     </ul>
                 </div> <!-- End concept-panel -->
            </div> <!-- End concept-block -->

            <div class="concept-block">
                <h3 class="concept-header">Diffie-Hellman Key Exchange</h3>
                <div class="concept-panel">
                    <p>Allows two parties to establish a shared secret (symmetric key) over an insecure channel.</p>
                    <h4>Algorithm Steps</h4>
                    <ol>
                        <li>Alice and Bob agree on large prime <var>P</var> and a primitive root generator <var>G</var> (both public).</li>
                        <li>Alice chooses a secret random integer <var>a</var>. Bob chooses a secret random integer <var>b</var>.</li>
                        <li>Alice computes her public key: A = G<sup>a</sup> mod P. Sends A to Bob.</li>
                        <li>Bob computes his public key: B = G<sup>b</sup> mod P. Sends B to Alice.</li>
                        <li>Alice computes the shared secret: S = B<sup>a</sup> mod P = (G<sup>b</sup>)<sup>a</sup> mod P.</li>
                         <li>Bob computes the shared secret: S = A<sup>b</sup> mod P = (G<sup>a</sup>)<sup>b</sup> mod P.</li>
                        <li>Both now share the same secret key S = G<sup>ab</sup> mod P, which was never transmitted directly.</li>
                    </ol>
                    <div class="example">
                        <p><strong>Diffie-Hellman Example (Slide 36):</strong></p>
                        <ol>
                            <li>Public numbers: P = 23, G = 9.</li>
                            <li>Alice secret a = 4. Bob secret b = 3.</li>
                            <li>Alice computes public key: A = G<sup>a</sup> mod P = 9<sup>4</sup> mod 23 = 6561 mod 23 = 6.</li>
                            <li>Bob computes public key: B = G<sup>b</sup> mod P = 9<sup>3</sup> mod 23 = 729 mod 23 = 16.</li>
                            <li>Alice and Bob exchange public keys A=6, B=16.</li>
                            <li>Alice computes shared secret: S = B<sup>a</sup> mod P = 16<sup>4</sup> mod 23 = 65536 mod 23 = 9.</li>
                            <li>Bob computes shared secret: S = A<sup>b</sup> mod P = 6<sup>3</sup> mod 23 = 216 mod 23 = 9.</li>
                         </ol>
                        <div class="solution"><strong>Shared Secret Key = 9</strong></div>
                    </div>
                </div> <!-- End concept-panel -->
            </div> <!-- End concept-block -->

             <div class="concept-block">
                 <h3 class="concept-header">Other Asymmetric Systems</h3>
                 <div class="concept-panel">
                     <ul>
                         <li><strong>ElGamal Cryptosystem:</strong> Based on Diffie-Hellman concepts and discrete logarithm problem. Used for digital signatures (part of DSS) and encryption.</li>
                         <li><strong>Elliptic Curve Cryptography (ECC):</strong> Uses mathematics of elliptic curves. Provides equivalent security to RSA with much smaller keys, leading to better performance (important for mobile/constrained devices). Used for key exchange and digital signatures.</li>
                     </ul>
                 </div> <!-- End concept-panel -->
             </div> <!-- End concept-block -->

        </section>

        <!-- Quiz Sections -->
        <div id="fill" class="main-content">
            <h2>Fill in the Blank Questions</h2>
            <div id="fill-questions"></div>
        </div>

        <div id="tf" class="main-content">
            <h2>True/False Questions</h2>
            <div id="tf-questions"></div>
        </div>

        <div id="mc" class="main-content">
            <h2>Multiple Choice Questions</h2>
            <div id="mc-questions"></div>
        </div>

    </div> <!-- End Container -->

     <script>
        // --- START OF QUIZ DATA (UNIT 3) ---
        const fillInTheBlank = [
            { question: "Asymmetric cryptography uses a pair of keys: a public key and a _______ key.", options: ["Shared", "Secret", "Session", "Private"], answer: "Private" },
            { question: "In RSA, the modulus 'n' is calculated by multiplying two large _______ numbers, p and q.", options: ["Random", "Integer", "Prime", "Coprime"], answer: "Prime" },
            { question: "The public exponent 'e' in RSA must be relatively prime to _______.", options: ["n", "p", "q", "φ(n)"], answer: "φ(n)" },
            { question: "To encrypt a message using RSA, the sender uses the recipient's _______ key.", options: ["Private", "Shared", "Session", "Public"], answer: "Public" },
            { question: "To decrypt an RSA-encrypted message, the recipient uses their _______ key.", options: ["Public", "Shared", "Session", "Private"], answer: "Private" },
            { question: "Diffie-Hellman is primarily used for secure _______ exchange.", options: ["Message", "File", "Key", "Signature"], answer: "Key" },
            { question: "In Diffie-Hellman, the two parties calculate the same shared _______ without transmitting it directly.", options: ["Public key", "Private key", "Secret", "Modulus"], answer: "Secret" },
            { question: "ECC stands for _______ Curve Cryptography.", options: ["Elliptic", "Exponential", "Euclidean", "Elementary"], answer: "Elliptic" },
            { question: "A major advantage of ECC over RSA is that it offers similar security with _______ key sizes.", options: ["Larger", "Simpler", "Smaller", "Fixed"], answer: "Smaller" },
            { question: "Public key algorithms are generally _______ than symmetric key algorithms.", options: ["Faster", "Simpler", "Slower", "Older"], answer: "Slower" },
            { question: "Encrypting a message hash with the sender's private key creates a digital _______.", options: ["Certificate", "Envelope", "Signature", "Token"], answer: "Signature" },
             { question: "RSA decryption involves computing M = C<sup>d</sup> mod _______.", options: ["p", "q", "φ(n)", "n"], answer: "n" }
        ];

        const trueOrFalse = [
            { question: "Asymmetric encryption uses the same key for encryption and decryption.", answer: false },
            { question: "The private key in asymmetric cryptography can be safely shared publicly.", answer: false },
            { question: "RSA can be used for both encryption and digital signatures.", answer: true },
            { question: "In RSA, the security relies on the difficulty of computing φ(n).", answer: false }, // Relies on difficulty of factoring n
            { question: "Diffie-Hellman directly encrypts the messages exchanged between parties.", answer: false }, // It establishes a shared key for symmetric encryption
            { question: "Elliptic Curve Cryptography requires larger keys than RSA for the same level of security.", answer: false },
            { question: "Asymmetric cryptography is generally faster than symmetric cryptography.", answer: false },
            { question: "In RSA key generation, 'd' is the modular multiplicative inverse of 'e' modulo n.", answer: false }, // modulo φ(n)
            { question: "A hybrid approach uses symmetric crypto for key exchange and asymmetric for bulk data.", answer: false }, // Opposite is true
            { question: "Public keys are derived from mathematical functions that are easy to reverse.", answer: false }, // They are based on one-way functions (hard to reverse)
            { question: "Knowing the public key {e, n} in RSA makes it easy to find the private key {d, n}.", answer: false }, // Computationally infeasible
             { question: "PGP (Pretty Good Privacy) often uses a hybrid cryptographic approach.", answer: true }
        ];

        const multipleChoice = [
            { question: "Which key is used to encrypt a message for confidentiality in a public-key system?", options: ["Sender's Private Key", "Sender's Public Key", "Recipient's Private Key", "Recipient's Public Key"], answer: "Recipient's Public Key" },
            { question: "Which key is used to create a digital signature?", options: ["Sender's Private Key", "Sender's Public Key", "Recipient's Private Key", "Recipient's Public Key"], answer: "Sender's Private Key" },
            { question: "What is the primary purpose of the Diffie-Hellman algorithm?", options: ["Message Encryption", "Digital Signing", "Secure Key Exchange", "Password Hashing"], answer: "Secure Key Exchange" },
            { question: "In RSA, how is the modulus 'n' calculated?", options: ["p + q", "p - q", "p * q", "(p-1)*(q-1)"], answer: "p * q" },
            { question: "In RSA, how is Euler's Totient Function φ(n) calculated for n = p*q (where p, q are prime)?", options: ["p * q", "p + q", "(p*q) - 1", "(p-1)*(q-1)"], answer: "(p-1)*(q-1)" },
            { question: "Which algorithm provides similar security to RSA but with significantly smaller key sizes?", options: ["DES", "AES", "Diffie-Hellman", "ECC"], answer: "ECC" },
            { question: "What is a major disadvantage of asymmetric cryptography compared to symmetric?", options: ["Weaker security", "Slower speed", "Requires key pre-sharing", "Cannot be used for signatures"], answer: "Slower speed" },
            { question: "If Alice wants to send an encrypted message to Bob using RSA, which key does she use?", options: ["Alice's Public Key", "Alice's Private Key", "Bob's Public Key", "Bob's Private Key"], answer: "Bob's Public Key" },
            { question: "If Alice wants to digitally sign a message sent to Bob, which key does she use?", options: ["Alice's Public Key", "Alice's Private Key", "Bob's Public Key", "Bob's Private Key"], answer: "Alice's Private Key" },
            { question: "Which value must be kept absolutely secret in RSA?", options: ["n", "e", "d", "C (Ciphertext)"], answer: "d" }, // p and q also, but d is the private key exponent derived from them.
            { question: "What mathematical problem's difficulty is the security of Diffie-Hellman based on?", options: ["Integer Factorization", "Discrete Logarithm", "Elliptic Curve Point Addition", "Finding Modular Inverse"], answer: "Discrete Logarithm" },
            { question: "A common practice combining crypto types is called:", options: ["Pure Asymmetric", "Pure Symmetric", "Hybrid Cryptography", "Steganography"], answer: "Hybrid Cryptography" }
        ];
        // --- END OF QUIZ DATA ---

        // --- START OF SCRIPT LOGIC (PASTE FROM unit1.html/unit2.html) ---
        document.addEventListener('DOMContentLoaded', () => {
            // Select main tabs and content sections
            const mainTabButtons = document.querySelectorAll('.main-tabs .tab-button');
            const mainTabContents = document.querySelectorAll('.main-content');

            // Select quiz content containers
            const fillContainer = document.getElementById('fill-questions');
            const tfContainer = document.getElementById('tf-questions');
            const mcContainer = document.getElementById('mc-questions');

             // Select accordion elements (Glossary)
            const accordionHeaders = document.querySelectorAll('.accordion-header');

            // Select concept accordion elements
            const conceptHeaders = document.querySelectorAll('.concept-header');


            // --- Main Tab Switching Logic ---
            mainTabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab'); // Get the ID of the target content

                    // Deactivate all main buttons and content
                    mainTabButtons.forEach(btn => btn.classList.remove('active'));
                    mainTabContents.forEach(content => content.classList.remove('active'));

                    // Activate the clicked button
                    button.classList.add('active');

                    // Activate the corresponding content section
                    const targetContent = document.getElementById(tabId);
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                });
            });

            // --- Accordion Logic (for Glossary) ---
             accordionHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    // Toggle active class on the header for styling (+) (-) sign
                    this.classList.toggle('active');

                    // Get the panel sibling
                    const panel = this.nextElementSibling;

                    // Toggle the max-height for smooth transition
                    if (panel.style.maxHeight) {
                        // If panel is open, close it
                        panel.style.maxHeight = null;
                        panel.style.padding = "0 20px"; // Remove padding when closing
                    } else {
                         // If panel is closed, open it
                        panel.style.maxHeight = panel.scrollHeight + 40 + "px"; // Add some buffer
                        panel.style.padding = "15px 20px"; // Add padding back when opening
                    }

                    // --- Optional: Close other accordions ---
                    accordionHeaders.forEach(otherHeader => {
                        if (otherHeader !== this && otherHeader.classList.contains('active')) {
                            otherHeader.classList.remove('active');
                            otherHeader.nextElementSibling.style.maxHeight = null;
                            otherHeader.nextElementSibling.style.padding = "0 20px";
                        }
                    });
                    // --- End Optional Close Others ---
                });
            });

            // --- Accordion Logic (for Concepts) ---
             conceptHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const panel = this.nextElementSibling; // The .concept-panel div

                    if (panel.style.maxHeight) {
                        panel.style.maxHeight = null;
                        panel.style.padding = "0 20px";
                    } else {
                        panel.style.maxHeight = panel.scrollHeight + 40 + "px"; // Add buffer
                        panel.style.padding = "15px 20px"; // Use padding defined in CSS or adjust as needed
                    }

                    // Optional: Close other concept panels
                    conceptHeaders.forEach(otherHeader => {
                        if (otherHeader !== this && otherHeader.classList.contains('active')) {
                            otherHeader.classList.remove('active');
                            const otherPanel = otherHeader.nextElementSibling;
                            otherPanel.style.maxHeight = null;
                            otherPanel.style.padding = "0 20px";
                        }
                    });
                });
            });


            // --- Function to handle option selection within a question ---
            function handleOptionSelection(button, questionDiv) {
                // Deselect siblings within the same question
                const siblings = questionDiv.querySelectorAll('.option-button.selected');
                siblings.forEach(sib => sib.classList.remove('selected'));
                // Select clicked button
                button.classList.add('selected');
                 // Clear previous feedback when a new option is selected
                const existingFeedback = questionDiv.querySelector('.feedback');
                if (existingFeedback) {
                    existingFeedback.remove();
                }
            }

            // --- Function to create and append feedback ---
            function showFeedback(questionDiv, isCorrect, correctAnswer) {
                 // Remove existing feedback first
                const existingFeedback = questionDiv.querySelector('.feedback');
                if (existingFeedback) {
                    existingFeedback.remove();
                }

                const feedback = document.createElement('div');
                feedback.className = 'feedback';
                if (isCorrect) {
                    feedback.classList.add('correct');
                    feedback.textContent = 'Correct!';
                } else {
                    feedback.classList.add('incorrect');
                     // For T/F, explicitly show the boolean value
                     let displayAnswer = correctAnswer;
                     if (typeof correctAnswer === 'boolean') {
                         displayAnswer = correctAnswer ? 'True' : 'False';
                     }
                    feedback.textContent = `Incorrect. Correct answer: ${displayAnswer}`;
                }
                // Append feedback after the check button
                const checkButton = questionDiv.querySelector('.check-answer');
                 if (checkButton) {
                    // Insert after the check button if it exists
                    checkButton.parentNode.insertBefore(feedback, checkButton.nextSibling);
                } else {
                     // Otherwise, append to the end of the question div
                     questionDiv.appendChild(feedback);
                }
            }

            // --- Load Fill in the Blank Questions ---
            function loadFillInTheBlankQuestions() {
                fillContainer.innerHTML = ''; // Clear previous content
                fillInTheBlank.forEach((q, index) => { // Added index for unique IDs if needed
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question';
                    questionDiv.id = `fill-q-${index}`;

                    const questionText = document.createElement('p');
                    // Find the blank spot indicated by _______ and replace it for display
                    questionText.innerHTML = q.question.replace('_______', '<span style="color: #007bff; font-weight:bold;">_______</span>');
                    questionDiv.appendChild(questionText);

                    const optionsDiv = document.createElement('div');
                    optionsDiv.className = 'options';

                    q.options.forEach(option => {
                        const optionButton = document.createElement('button');
                        optionButton.className = 'option-button';
                        optionButton.textContent = option;
                        optionButton.addEventListener('click', () => handleOptionSelection(optionButton, questionDiv));
                        optionsDiv.appendChild(optionButton);
                    });
                    questionDiv.appendChild(optionsDiv);

                    const checkButton = document.createElement('button');
                    checkButton.className = 'check-answer';
                    checkButton.textContent = 'Check Answer';
                    checkButton.addEventListener('click', () => {
                        const selected = questionDiv.querySelector('.option-button.selected');
                        if (selected) {
                            showFeedback(questionDiv, selected.textContent === q.answer, q.answer);
                        } else {
                             // Optionally show feedback that an answer must be selected
                             showFeedback(questionDiv, false, q.answer); // Or provide specific feedback
                        }
                    });
                    questionDiv.appendChild(checkButton);

                    fillContainer.appendChild(questionDiv);
                });
            }


            // --- Load True/False Questions ---
            function loadTrueFalseQuestions() {
                tfContainer.innerHTML = ''; // Clear previous content
                trueOrFalse.forEach((q, index) => { // Added index
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question';
                    questionDiv.id = `tf-q-${index}`;

                    const questionText = document.createElement('p');
                    questionText.textContent = q.question;
                    questionDiv.appendChild(questionText);

                     const optionsDiv = document.createElement('div'); // Keep consistent structure
                    optionsDiv.className = 'options';

                    const trueButton = document.createElement('button');
                    trueButton.className = 'option-button';
                    trueButton.textContent = 'True';
                    trueButton.addEventListener('click', () => handleOptionSelection(trueButton, questionDiv));
                    optionsDiv.appendChild(trueButton);

                    const falseButton = document.createElement('button');
                    falseButton.className = 'option-button';
                    falseButton.textContent = 'False';
                    falseButton.addEventListener('click', () => handleOptionSelection(falseButton, questionDiv));
                    optionsDiv.appendChild(falseButton);

                    questionDiv.appendChild(optionsDiv);

                    const checkButton = document.createElement('button');
                    checkButton.className = 'check-answer';
                    checkButton.textContent = 'Check Answer';
                    checkButton.addEventListener('click', () => {
                        const selected = questionDiv.querySelector('.option-button.selected');
                        if (selected) {
                            // Check boolean answer correctly
                            const isCorrect = (selected.textContent === 'True' && q.answer === true) || (selected.textContent === 'False' && q.answer === false);
                            showFeedback(questionDiv, isCorrect, q.answer); // Pass boolean directly
                        } else {
                            showFeedback(questionDiv, false, q.answer); // Pass boolean directly
                        }
                    });
                    questionDiv.appendChild(checkButton);

                    tfContainer.appendChild(questionDiv);
                });
            }

            // --- Load Multiple Choice Questions ---
            function loadMultipleChoiceQuestions() {
                mcContainer.innerHTML = ''; // Clear previous content
                multipleChoice.forEach((q, index) => { // Added index
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question';
                    questionDiv.id = `mc-q-${index}`;

                    const questionText = document.createElement('p');
                    questionText.textContent = q.question;
                    questionDiv.appendChild(questionText);

                    const optionsDiv = document.createElement('div');
                    optionsDiv.className = 'options';

                    // Shuffle options for variety (optional)
                    // const shuffledOptions = [...q.options].sort(() => Math.random() - 0.5);

                    q.options.forEach(option => { // Use original options or shuffledOptions
                        const optionButton = document.createElement('button');
                        optionButton.className = 'option-button';
                        optionButton.textContent = option;
                        optionButton.addEventListener('click', () => handleOptionSelection(optionButton, questionDiv));
                        optionsDiv.appendChild(optionButton);
                    });
                    questionDiv.appendChild(optionsDiv);

                    const checkButton = document.createElement('button');
                    checkButton.className = 'check-answer';
                    checkButton.textContent = 'Check Answer';
                    checkButton.addEventListener('click', () => {
                        const selected = questionDiv.querySelector('.option-button.selected');
                        if (selected) {
                            showFeedback(questionDiv, selected.textContent === q.answer, q.answer);
                        } else {
                             showFeedback(questionDiv, false, q.answer);
                        }
                    });
                    questionDiv.appendChild(checkButton);

                    mcContainer.appendChild(questionDiv);
                });
            }

            // --- Initial Load ---
            // Load all quiz questions initially so they are ready when tabs are clicked
            loadFillInTheBlankQuestions();
            loadTrueFalseQuestions();
            loadMultipleChoiceQuestions();

             // Activate the default tab's content on load using CSS class (no direct style manipulation needed here)
             // document.querySelector('.main-content.active').style.display = 'block'; // This line is removed/commented out


        }); // End DOMContentLoaded
        // --- END OF SCRIPT LOGIC ---
    </script>
</body>
</html>
